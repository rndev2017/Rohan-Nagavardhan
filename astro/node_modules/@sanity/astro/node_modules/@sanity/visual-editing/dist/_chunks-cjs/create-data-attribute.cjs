"use strict";var t=require("@sanity/client/csm"),e=require("valibot");function r(t){return null!==t&&Array.isArray(t)}function o(t){let e="";for(const o of t)"string"!=typeof o?"number"!=typeof o?r(o)?(e&&(e+=":"),e+=`${o.join(",")}}`):o._key&&(e&&(e+=":"),e+=`${o._key}`):(e&&(e+=":"),e+=`${o}`):(e&&(e+="."),e+=o);return e}const n=/^([A-Za-z]+):([0-9]+)$/,a=/^([A-Za-z]+):([0-9]+),([0-9]+)$/,s=/^([A-Za-z]+):([a-z0-9]+)$/;const i="drafts.",c=e.string([e.minLength(1)]),u=e.optional(c),p=e.object({baseUrl:c,dataset:u,id:c,path:c,projectId:u,tool:u,type:u,workspace:u,isDraft:e.optional(e.string())}),f=e.object({origin:c,href:c,data:e.optional(e.record(e.string(),e.unknown()))});function d(t){return e.is(p,t)}function h(e){const r=e.split(";").reduce(((e,r)=>{const[o,i]=r.split("=");if(!o||r.includes("=")&&!i)return e;switch(o){case"id":e.id=i;break;case"type":e.type=i;break;case"path":e.path=t.studioPath.toString(function(t){const e=[];for(const r of t.split(".")){const t=n.exec(r);if(t){e.push(t[1],Number(t[2]));continue}const o=a.exec(r);if(o){e.push(o[1],[Number(o[2]),Number(o[3])]);continue}const i=s.exec(r);i?e.push(i[1],{_key:i[2]}):e.push(r)}return e}(i));break;case"base":e.baseUrl=decodeURIComponent(i);break;case"tool":e.tool=i;break;case"workspace":e.workspace=i;break;case"projectId":e.projectId=i;break;case"dataset":e.dataset=i;break;case"isDraft":e.isDraft=""}return e}),{});if(d(r))return r}function l(t){const r=e.safeParse(p,t);if(r.success)return r.output;const o=e.safeParse(f,t);if(o.success)try{const t=new URL(o.output.href,typeof document>"u"?"https://example.com":location.origin);return t.searchParams.size>0?e.parse(p,Object.fromEntries(t.searchParams.entries())):o.output}catch(t){return console.error("Failed to parse sanity node",t),o.output}}const y={alt:"altKey",ctrl:"ctrlKey",mod:typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"};exports.I=function(t){if("object"==typeof t&&null!==t)return l(t);try{return l(JSON.parse(t))}catch{return h(t)}},exports.c=function(t){return"Alt"===t.key},exports.d=o,exports.k=i,exports.o=function e(r){function n(e){return e?"string"==typeof e?t.studioPath.fromString(e):e:[]}function a(e){if(!e.id)throw new Error("`id` is required to create a data attribute");if(!e.type)throw new Error("`type` is required to create a data attribute");if(!e.path||!e.path.length)throw new Error("`path` is required to create a data attribute");return function(e){const{id:r,path:n,baseUrl:a,tool:s,workspace:c,type:u}=e;return d(e)?[["id",t.getPublishedId(r)],["type",u],["path",o(t.studioPath.fromString(n))],["base",encodeURIComponent(a)],["workspace",c],["tool",s],["isDraft",r.startsWith(i)]].filter((([,t])=>!!t)).map((t=>{const[e,r]=t;return!0===r?e:t.join("=")})).join(";"):void 0}({baseUrl:e.baseUrl||"/",workspace:e.workspace,tool:e.tool,type:e.type,id:e.id,path:"string"==typeof e.path?e.path:t.studioPath.toString(e.path)})}const s=t=>a({...r,path:[...n(r.path),...n(t)]});return s.toString=function(){return a(r)},s.combine=function(t){return e({...r,...t})},s.scope=function(t){return e({...r,path:[...n(r.path),...n(t)]})},s},exports.p=function(t,e){return t.every((t=>y[t]?e[y[t]]:e.key===t.toUpperCase()))};//# sourceMappingURL=create-data-attribute.cjs.map
