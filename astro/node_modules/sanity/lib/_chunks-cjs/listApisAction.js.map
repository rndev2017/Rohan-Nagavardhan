{"version":3,"file":"listApisAction.js","sources":["../../src/_internal/cli/actions/graphql/listApisAction.ts"],"sourcesContent":["import {type CliCommandArguments, type CliCommandContext} from '@sanity/cli'\n\nimport {getClientUrl} from '../../util/getClientUrl'\n\ntype ListApisResponse = {\n  projectId: string\n  dataset: string\n  tag: string\n  playgroundEnabled: boolean\n  generation: string\n}[]\n\nexport default async function listGraphQLApis(\n  args: CliCommandArguments<Record<string, unknown>>,\n  context: CliCommandContext,\n): Promise<void> {\n  const {apiClient, output, chalk} = context\n\n  const client = apiClient({\n    requireUser: true,\n    requireProject: true,\n  }).config({apiVersion: '2023-08-01'})\n\n  let endpoints: ListApisResponse | undefined\n  try {\n    endpoints = await client.request<ListApisResponse>({\n      url: '/apis/graphql',\n      method: 'GET',\n    })\n  } catch (err) {\n    throw err\n  }\n\n  if (!endpoints || endpoints.length === 0) {\n    output.print(\"This project doesn't have any GraphQL endpoints deployed.\")\n    return\n  }\n\n  output.print('Here are the GraphQL endpoints deployed for this project:')\n  endpoints.forEach((endpoint, index) => {\n    const {dataset, tag} = endpoint\n    const url = getClientUrl(client, `graphql/${dataset}/${tag}`)\n\n    output.print(`${index + 1}.  ${chalk.bold('Dataset:')}     ${dataset}`)\n    output.print(`    ${chalk.bold('Tag:')}         ${tag}`)\n    output.print(`    ${chalk.bold('Generation:')}  ${endpoint.generation}`)\n    output.print(`    ${chalk.bold('Playground:')}  ${endpoint.playgroundEnabled}`)\n    output.print(`    ${chalk.bold('URL:')}  ${url}\\n`)\n  })\n}\n"],"names":["getClientUrl"],"mappings":";;AAY8B,eAAA,gBAC5B,MACA,SACe;AACf,QAAM,EAAC,WAAW,QAAQ,MAAS,IAAA,SAE7B,SAAS,UAAU;AAAA,IACvB,aAAa;AAAA,IACb,gBAAgB;AAAA,EACjB,CAAA,EAAE,OAAO,EAAC,YAAY,aAAa,CAAA;AAEhC,MAAA;AACA,MAAA;AACU,gBAAA,MAAM,OAAO,QAA0B;AAAA,MACjD,KAAK;AAAA,MACL,QAAQ;AAAA,IAAA,CACT;AAAA,WACM,KAAK;AACN,UAAA;AAAA,EACR;AAEA,MAAI,CAAC,aAAa,UAAU,WAAW,GAAG;AACxC,WAAO,MAAM,2DAA2D;AACxE;AAAA,EACF;AAEA,SAAO,MAAM,2DAA2D,GACxE,UAAU,QAAQ,CAAC,UAAU,UAAU;AACrC,UAAM,EAAC,SAAS,IAAG,IAAI,UACjB,MAAMA,UAAa,aAAA,QAAQ,WAAW,OAAO,IAAI,GAAG,EAAE;AAErD,WAAA,MAAM,GAAG,QAAQ,CAAC,MAAM,MAAM,KAAK,UAAU,CAAC,QAAQ,OAAO,EAAE,GACtE,OAAO,MAAM,OAAO,MAAM,KAAK,MAAM,CAAC,YAAY,GAAG,EAAE,GACvD,OAAO,MAAM,OAAO,MAAM,KAAK,aAAa,CAAC,KAAK,SAAS,UAAU,EAAE,GACvE,OAAO,MAAM,OAAO,MAAM,KAAK,aAAa,CAAC,KAAK,SAAS,iBAAiB,EAAE,GAC9E,OAAO,MAAM,OAAO,MAAM,KAAK,MAAM,CAAC,KAAK,GAAG;AAAA,CAAI;AAAA,EAAA,CACnD;AACH;;"}